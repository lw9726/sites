# 群晖钉钉内网穿透

采用群晖shell脚本计划任务实现内网穿透，内网穿透项目由阿里钉钉团队开发（没错就是那个钉钉），本来用于开发调试，这里拿来作为群晖内网穿透。

优点：

1. 免费
2. 自带顶级域名，自定义二级域名
3. 低延迟
4. 不限速（没详细测试）

资料：

钉钉内网穿透项目：https://github.com/open-dingtalk/pierced

钉钉内网穿透开发文档：https://open.dingtalk.com/document/resourcedownload/http-intranet-penetration

> **注意** 
>
> 鉴于很多开发者在临时体验开发时往往没有公网域名或者公网IP，本工具提供了一个公网代理服务，目的是方便开发测试。
>
> 本工具不保证稳定性，仅适用于开发测试阶段，禁止当作公网域名使用。如线上应用使用本工具造成稳定性问题，后果由自己承担。如使用本工具传播违法不良信息，钉钉将追究法律责任。
>
> ——顶顶团队

## 第一步，下载程序和配置文件

使用群晖的Download Station套件下载到一个不随意变更的位置

![](https://img-blog.csdnimg.cn/img_convert/c9836a1953d0c7583cc34ac716e0b5fe.png)

右键ding程序-属性-复制完整文件路径，待会用

程序：https://gitee.com/vww/pierced/raw/master/linux/ding

配置文件：https://gitee.com/vww/pierced/raw/master/linux/ding.cfg

# 第二步，添加任务计划

打开群晖，点击控制面板-任务计划

![task](https://image-uploader.oss-cn-beijing.aliyuncs.com/img/task.jpg)

新增-触发的任务-用户自定义的脚本

常规里，任务名不能中文，用户改为root

![rwjh2](http://image-uploader.oss-cn-beijing.aliyuncs.com/img/rwjh2.jpg)

任务设置里，粘贴如下2行代码

```bash
cd /volume1/downloads/
./ding -config=./ding.cfg -subdomain=dsm198 5000
```

> 说明：cd 加空格后跟的为目录，ding文件所在目录的路径
>
> 图中dsm198即我所自定义的二级域名，这里随你喜欢，例如你改为abc123，则最终的群晖后台访问地址为http://abc123.vaiwan.com（不是http://abc123.vaiwan.com:5000）
>
> 尽量不必要和别重复，重复的话地址可能变为http://abc123.vaiwan.com:8084之类的，只有通过ssh登录群晖后台查看日志才能看得到具体是多少

![shel](https://image-uploader.oss-cn-beijing.aliyuncs.com/img/shel.jpg)



保存应用，重启后生效。

外网访问地址http://你自己设置的二级域名.vaiwan.com

本次演示的地址为http://dsm198.vaiwan.com，不要带5000不要带5000不要带5000，如果无法访问，前面说了原因，方法为修改二级域名不要和别人重复

